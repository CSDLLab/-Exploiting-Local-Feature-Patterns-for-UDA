#!/bin/bash

# abort entire script on error
set -e

export PYTHONPATH="$PWD:$PYTHONPATH"


##########amazon####
python3.5 tools/train_VGG16_multigpu.py amazon train VGG16_original VGG16_amazon32kconv5_novlad_post1\
       --iterations 1800 \
       --batch_size 128 \
       --display 50 \
       --lr 0.00006 \
       --snapshot 1800 \
       --weights snapshot/VGG16\
       --solver adam   \
       --pretrainflag 1   \
       --netvladflag 0

 ##########amazon adda ####
python3.5 tools/train_adda_Alexnet_multigpu_local2.py amazon:train dslr:train VGG16_original adda_VGG16_amazon2dslr_32kconv5_novlad_post_adda \
       --iterations 3900 \
       --batch_size 128 \
       --display 50 \
       --lr 0.0001 \
       --snapshot 3900 \
       --weights snapshot/VGG16_amazon32kconv5_novlad_post1\
       --adversary_relu \
       --solver adam  \
       --netvladflag 0


python3.5 tools/train_adda_Alexnet_multigpu_local2.py amazon:train webcam:train VGG16_original adda_VGG16_amazon2webcam_32kconv5_novlad_post_adda \
       --iterations 3900 \
       --batch_size 128 \
       --display 50 \
       --lr 0.0001 \
       --snapshot 3900 \
       --weights snapshot/VGG16_amazon32kconv5_novlad_post1\
       --adversary_relu \
       --solver adam  \
       --netvladflag 0



python3.5 tools/eval_vgg16_target.py dslr train VGG16_original snapshot/adda_VGG16_amazon2dslr_32kconv5_novlad_post_adda --netvladflag 1
python3.5 tools/eval_vgg16_target.py webcam train VGG16_original snapshot/adda_VGG16_amazon2webcam_32kconv5_novlad_post_adda --netvladflag 1

